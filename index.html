<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    :root{
        --toast-width: 20em;
        --toast-left-offset: calc(var(--toast-width)/2);
    }
    *{
        padding: 0;
        margin: 0;
        font-family:Verdana, Geneva, Tahoma, sans-serif;
    }
    .toast{
        position: absolute;
        width:var(--toast-width);
        height: 3em;
        top: 0;
        left: calc(50vh - var(--toast-left-offset));
        background-color: black;
        border-radius: 2em;
        display: flex;
        align-items: center;
        padding-left: 2em;
    }
    .toast p{
        color: white;
        font-size: medium;
    }
    td{
        padding: .2rem;
    }

</style>
<body>

    <div>
        <form id="formLogin">
            <div>
                <div>
                    <input 
                        id="txtUserName" 
                        type="text" 
                        placeholder="Enter A User Name"/>
                    <input 
                        id="txtPassword" 
                        type="password" 
                        placeholder="Enter A Password"/>
                    <button 
                        type="button"
                        onclick="submitclick()"
                        >
                        Login
                    </button>
                </div>
            </div>
        </form>
    </div>
    <div id="tableDiv">

    </div>

    <button onclick="ActivateToast()">Toast</button>
    <button onclick="DeleteTrent()">Delete Trenton</button>
    <button onclick="AddNew()">Add New User</button>

    <script src="./utils.js"></script>
    <script src="./users.js"></script>
    <script src="./toast.js"></script>
    <script src="./dataBase.js"></script>
    <script src="./createGrid.js"></script>
    <script src="./createLoginForm.js"></script>

    <script>
        //Testing
        const log = str => console.log(str);
        const txtUserName = document.querySelector('#txtUserName');
        const txtPassword = document.querySelector('#txtPassword');
        txtUserName.value = 'tweir12';
        txtPassword.value = 'VerySecure?';

    </script>
    <script>

        const TryLogon = () => {
            const loginAttempt = new LogIn({
                UserName: txtUserName.value,
                Password: txtPassword.value
            });
            loginAttempt.Evaluate();

            if(loginAttempt.IsValid){
                let toast = new Toast({
                    Message: `Welcome ${txtUserName.value}`,
                    timeout: (10 * 1000)
                });
                toast.Show();
                return true;
            }
            else{
                let toast = new Toast({
                    Message: `Incorrect username or password.`,
                    timeout: (10 * 1000)
                });
                toast.Show();
                return false;
            }
        }
        
        const submitclick = () => {
            try{
                TryLogon();
            }
            catch(e){
                log(e)
                var t = new Toast({
                    Message:e.message,
                    timeout: (10 * 1000)
                });
                t.Show();
            }
        }
        

        const ActivateToast = () => {
            log('toast');
            var tst = new Toast({
                Message: 'New Toast',
                timeout: (10 * 1000)
            });
            tst.Show();

        }

        let db = new DataBase();
        db.init();
        let loginUserNames = new Gridify({
            data: db.Users,
            tableParentObject: document.querySelector('#tableDiv'),
        });
        loginUserNames.init();


        ///HOW TO USE THE GRID

        //1. CREATE GRID OBJECT, MUST HAVE a data parameter that is an array of objects.
        
        const tableObj = {
            //Required
            data: [
                {
                    Name: "Trenton Weir",
                    UserName: "tweir12",
                    Password: "AReallySecurePassword"
                },
                {
                    Name:"John Doe",
                    UserName: "TheDooo",
                    Password: "Super Chill"
                },
                {
                    Name:"Megan Yokai",
                    UserName: "SuperNatural123",
                    Password: "ScaryGhostLady123"
                }
            ],
            //Not required but recommended. 
            //This is just the element that you want your table to be inside. 
            tableParentObject: document.querySelector('#tableDiv'),
        }

        //create the instance of the object, and ust the object you created
        //above for the constructor obj
        const usersGrid = new Gridify(tableObj);
        //Call init
        usersGrid.init();

        // These can be added to buttons or other means to edit tables
        //Adds data to grid
        //Requires an Object similar to what you used for the table
        const AddNew = () => usersGrid.addData({Name:"New", UserName: 'New', Password:"New"});

        //Removes data from grid. 
        //Requires the object you want to remove and the key to identify with
        //alternativly you can just enter a value and it will remove all objects 
        //that have it 
        const DeleteTrent = () => usersGrid.removeData({
            Name: "Trenton Weir",
            UserName: "tweir12",
            Password: "AReallySecurePassword"
        }, 'UserName');


    </script>
    
</body>
</html>